# Sprint 2025-06-04

# Fix Sincronizzazione Tree dopo Modifica/Creazione File

## 🎯 Obiettivo Sprint

Risolvere il problema di sincronizzazione tra tree e contenuto principale quando vengono modificati o creati nuovi file markdown.

## 📋 Backlog Items

### Epic: Sincronizzazione Tree-Content

**Priorità**: ALTA\
**Stima**: 2-3 ore\
**Descrizione**: Quando un file viene modificato o creato, il tree non si sincronizza automaticamente con il contenuto visualizzato.

***

## 🔧 Sprint Tasks

### Task 1: Analisi e Conferma Fix

**Durata stimata**: 15 minuti\
**Assignee**: Developer

#### Subtask 1.1: Verificare il metodo markdownFileIsChanged

* [ ] Aprire `MdExplorer/client2/src/app/md-explorer/components/main-content/main-content.component.ts`
* [ ] Localizzare il metodo `markdownFileIsChanged()` (linee \~63-81)
* [ ] Confermare che attualmente chiama solo `setSelectedMdFileFromServer(data)`
* [ ] Verificare che NON chiama `setSelectedMdFileFromSideNav(data)`

#### Subtask 1.2: Analisi dei dati ricevuti

* [ ] Controllare che l'oggetto `data` contenga i campi `relativePath` e `path`
* [ ] Verificare compatibilità con il metodo `setSelectedMdFileFromSideNav()`

***

### Task 2: Implementazione Fix

**Durata stimata**: 30 minuti\
**Assignee**: Developer

#### Subtask 2.1: Backup e preparazione

* [ ] Creare backup del file `main-content.component.ts`
* [ ] Aprire il file in modalità edit

#### Subtask 2.2: Modifica del codice

* [ ] Localizzare il metodo `markdownFileIsChanged()`
* [ ] Aggiungere la riga: `objectThis.service.setSelectedMdFileFromSideNav(data);`
* [ ] Posizionarla subito dopo: `objectThis.service.setSelectedMdFileFromServer(data);`
* [ ] Salvare il file

#### Subtask 2.3: Verifica sintattica

* [ ] Eseguire `npm run lint` nel progetto Angular
* [ ] Correggere eventuali errori di linting
* [ ] Verificare che non ci siano errori TypeScript

***

### Task 3: Build e Test Preparazione

**Durata stimata**: 20 minuti\
**Assignee**: Developer

#### Subtask 3.1: Build del progetto

* [ ] Eseguire `npm run build` in `MdExplorer/client2/`
* [ ] Verificare che la build completi senza errori
* [ ] Controllare che i file siano generati in `wwwroot/client2/`

#### Subtask 3.2: Avvio servizi

* [ ] Avviare il backend .NET Core (`dotnet run` in MdExplorer/)
* [ ] Verificare che l'applicazione sia accessibile su `http://localhost:5000`
* [ ] Confermare che SignalR sia connesso

***

### Task 4: Test Manuali - Scenario 1 (File Modificati)

**Durata stimata**: 20 minuti\
**Assignee**: Tester

#### Subtask 4.1: Preparazione test

* [ ] Aprire l'applicazione MdExplorer nel browser
* [ ] Navigare ad un file markdown esistente nel tree
* [ ] Verificare che il file sia visualizzato correttamente

#### Subtask 4.2: Test modifica file

* [ ] Aprire il file con un editor esterno (VS Code, Notepad++)
* [ ] Fare una modifica significativa al contenuto
* [ ] Salvare il file
* [ ] **ASPETTATO**: Il contenuto dovrebbe aggiornarsi automaticamente senza click sul tree
* [ ] **VERIFICARE**: Il nodo nel tree dovrebbe rimanere selezionato/evidenziato

#### Subtask 4.3: Test multipli

* [ ] Ripetere il test con almeno 2 file diversi
* [ ] Testare con file in sottocartelle
* [ ] Verificare che funzioni con diversi tipi di modifiche (testo, titoli, liste)

***

### Task 5: Test Manuali - Scenario 2 (File Creati)

**Durata stimata**: 15 minuti\
**Assignee**: Tester

#### Subtask 5.1: Test creazione file

* [ ] Creare un nuovo file .md nella cartella root del progetto
* [ ] Aggiungere contenuto markdown (titolo, paragrafo)
* [ ] Salvare il file
* [ ] **ASPETTATO**: Il nuovo file dovrebbe apparire nel tree E visualizzarsi automaticamente
* [ ] **VERIFICARE**: Il nuovo nodo dovrebbe essere selezionato/evidenziato

#### Subtask 5.2: Test in sottocartelle

* [ ] Creare un nuovo file in una sottocartella
* [ ] Verificare che appaia nel tree e si visualizzi automaticamente
* [ ] Testare anche con nomi file che contengono spazi o caratteri speciali

***

### Task 6: Test di Regressione

**Durata stimata**: 25 minuti\
**Assignee**: Tester

#### Subtask 6.1: Test navigazione normale

* [ ] Cliccare manualmente su vari file nel tree
* [ ] Verificare che la navigazione funzioni ancora correttamente
* [ ] Controllare che i file si aprano e visualizzino normalmente

#### Subtask 6.2: Test funzionalità correlate

* [ ] Testare il sistema TOC (table of contents)
* [ ] Verificare la navigazione breadcrumb
* [ ] Controllare che i riferimenti/link funzionino
* [ ] Testare l'apertura di file da cronologia

#### Subtask 6.3: Test performance

* [ ] Aprire DevTools e monitorare console
* [ ] Verificare che non ci siano errori JavaScript
* [ ] Controllare che gli eventi multipli SignalR non causino problemi
* [ ] Verificare tempi di risposta accettabili

***

### Task 7: Validazione e Pulizia

**Durata stimata**: 15 minuti\
**Assignee**: Developer

#### Subtask 7.1: Verifica log

* [ ] Controllare console browser per errori
* [ ] Verificare log backend per eccezioni
* [ ] Confermare che SignalR funzioni correttamente

#### Subtask 7.2: Code review

* [ ] Rivedere la modifica implementata
* [ ] Verificare che non ci siano side effects
* [ ] Documentare eventuali osservazioni

#### Subtask 7.3: Commit preparazione

* [ ] Preparare commit con messaggio descrittivo
* [ ] **NON COMMITTARE** ancora - attendere approvazione finale

***

## 📊 Definition of Done

### Per il task completato:

* [ ] ✅ File modificati vengono visualizzati automaticamente senza click nel tree
* [ ] ✅ File creati vengono visualizzati automaticamente senza click nel tree
* [ ] ✅ Il nodo corrente rimane selezionato/evidenziato dopo modifiche
* [ ] ✅ La navigazione manuale continua a funzionare normalmente
* [ ] ✅ Non ci sono errori in console o log backend
* [ ] ✅ Tutti i test manuali passano
* [ ] ✅ Build completa senza errori
* [ ] ✅ Code review completata

## 🚨 Criteri di Fallimento

Se uno qualsiasi di questi si verifica, fermare lo sprint:

* [ ] ❌ La navigazione normale si rompe
* [ ] ❌ Errori JavaScript critici in console
* [ ] ❌ File non vengono più visualizzati
* [ ] ❌ Performance significativamente degradate
* [ ] ❌ SignalR smette di funzionare

## 📝 Note per il Test

### File di test raccomandati:

* `Fix-Generali.md` (già presente)
* `CLAUDE.md` (file esistente)
* `test-nuovo-file.md` (da creare)
* `sprints/test-subfolder.md` (da creare in sottocartella)

### Browser di test:

* Chrome (primario)
* Firefox (secondario se tempo disponibile)

### Modifiche tipo da testare:

1. Aggiungere/rimuovere testo
2. Modificare titoli (H1, H2, H3)
3. Aggiungere liste puntate
4. Inserire link e riferimenti

***

**Sprint Start**: 2025-06-04\
**Durata totale stimata**: 2h 20min\
**Team size**: 1 developer + 1 tester (o stessa persona)
